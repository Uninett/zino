Properly encode timedelta values as an integer number of seconds in the legacy API